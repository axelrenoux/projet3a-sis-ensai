------------selection des albums-----------------------
create view vCORRESP_Album_TAGTOP1 as
select album, min(tag) as tag from CORRESP_album_TAG group by album order by album

select 
album.cle_primaire as album,
id_name_url1.name as album,
artiste,
date_sortie,
id_name_url2.name as artiste,
vCORRESP_ALBUM_TAGTOP1.tag,
id_name_url3.name as tag,
audimat.listeners,
audimat.playcount
from album 
left join (artiste 
inner join id_name_url id_name_url2 on artiste.id_name_url=id_name_url2.cle_primaire) 
on artiste.cle_primaire = album.artiste
left join (vCORRESP_ALBUM_TAGTOP1 
inner join (tag 
inner join id_name_url id_name_url3 on tag.id_name_url = id_name_url3.cle_primaire)
on tag.cle_primaire =  vCORRESP_ALBUM_TAGTOP1.tag)
on album.cle_primaire = vCORRESP_ALBUM_TAGTOP1.album
inner join id_name_url id_name_url1 on album.id_name_url = id_name_url1.cle_primaire
inner join audimat on album.audimat = audimat.cle_primaire



---------------------------------------------------------------------------------
 
------------selection des artistes-----------------------

create view vartistes_similairesTOP1 as
select artiste1, min(artiste2) as artiste2 from artistes_similaires group by artiste1 order by artiste1

create view vCORRESP_ARTISTE_TAGTOP1 as
select artiste, min(tag) as tag from CORRESP_ARTISTE_TAG group by artiste order by artiste

select 
artiste.cle_primaire as artiste,
id_name_url1.name as artiste,
vartistes_similairestop1.artiste2 as artisteSim,
id_name_url2.name as artisteSim,
vCORRESP_ARTISTE_TAGTOP1.tag,
id_name_url3.name as tag,
audimat.listeners,
audimat.playcount
from artiste 
left join (vartistes_similairestop1 
inner join (artiste artistesimilaire 
inner join id_name_url id_name_url2 on artisteSimilaire.id_name_url=id_name_url2.cle_primaire) 
on artistesimilaire.cle_primaire = vartistes_similairestop1.artiste2) 
on artiste.cle_primaire = vartistes_similairestop1.artiste1
left join (vCORRESP_ARTISTE_TAGTOP1 
inner join (tag 
inner join id_name_url id_name_url3 on tag.id_name_url = id_name_url3.cle_primaire)
on tag.cle_primaire =  vCORRESP_ARTISTE_TAGTOP1.tag)
on artiste.cle_primaire = vCORRESP_ARTISTE_TAGTOP1.artiste
inner join id_name_url id_name_url1 on artiste.id_name_url = id_name_url1.cle_primaire
inner join audimat on artiste.audimat = audimat.cle_primaire


---------------------------------------------------------------------------------

------------selection des chansons-----------------------

create view vCORRESP_Chanson_TAGTOP1 as
select chanson, min(tag) as tag from CORRESP_chanson_TAG group by chanson order by chanson

select 
chanson.cle_primaire as chanson,
id_name_url1.name as chanson,
duree,
id_name_url2.name as artiste,
vCORRESP_CHANSON_TAGTOP1.tag,
id_name_url3.name as tag,
audimat.listeners,
audimat.playcount

from chanson 
left join (artiste 
inner join id_name_url id_name_url2 on artiste.id_name_url=id_name_url2.cle_primaire) 
on artiste.cle_primaire = chanson.artiste
left join (vCORRESP_CHANSON_TAGTOP1 
inner join (tag 
inner join id_name_url id_name_url3 on tag.id_name_url = id_name_url3.cle_primaire)
on tag.cle_primaire =  vCORRESP_CHANSON_TAGTOP1.tag)
on chanson.cle_primaire = vCORRESP_CHANSON_TAGTOP1.chanson
inner join id_name_url id_name_url1 on chanson.id_name_url = id_name_url1.cle_primaire
inner join audimat on chanson.audimat = audimat.cle_primaire
 